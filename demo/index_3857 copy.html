<!doctype html>
<html lang="en">
  <head>
    <style>
		  body { margin:0; padding: 0; width:100%; height:100%;}
		  .map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <script src="src/proj4-compressed.js"></script>
    <script src="src/proj4leaflet.js"></script>
    <title>rio-tiler CRS example</title>
  </head>
  <body>
    <div id="map" class="map"></div>
    
	  <script type="text/javascript">

    //var max_zoom = 16
    //var tile_size = 256
    //var extent = 84
    //var resolutions = Array(max_zoom + 1).fill().map((_, i) => ( extent / tile_size / Math.pow(2, i) ))
    //console.log(resolutions)
//
    //var crs = new L.Proj.CRS(
    //  'EPSG:32618',
    //  '+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs +type=crs',
    //  {
    //    origin: [-78.0, 84.0],
    //    bounds: L.bounds([-78.0, 84], [-72., 0]),
    //    resolutions: resolutions,          
    //  }),
    //map = new L.Map('map', {
    //  crs: crs,
    //});

      //L.tileLayer('http://0.0.0.0:8501/tiles/{z}/{x}/{y}.png', {
      //  maxZoom: crs.options.resolutions.length,
      //  minZoom: 0,
      //  continuousWorld: true,
      //  attribution: 'rio-tiler-crs'
      //}).addTo(map);

      // https://github.com/nasa-gibs/gibs-web-examples/blob/master/examples/leaflet/arctic-epsg3413.js
      var EPSG3413 = new L.Proj.CRS(
        'EPSG:3413',
        '+proj=stere +lat_0=90 +lat_ts=70 +lon_0=-45 +k=1 +x_0=0 +y_0=0 ' +
        '+ellps=WGS84 +datum=WGS84 +units=m +no_defs', {
          origin: [-4194304, 4194304],
          resolutions: [
            8192.0,
            4096.0,
            2048.0,
            1024.0,
            512.0,
            256.0,
            128.0,
            64.0,
            32.0,
          ],
          bounds: L.bounds([[-4194304, -4194304], [4194304, 4194304]])
        }
      )

      //north
      L.tileLayer('http://0.0.0.0:8501/tiles/epsg3413/{z}/{x}/{y}.png?filename=north_cog', {
        maxZoom: 12,
        minZoom: 7,
        continuousWorld: true,
        attribution: 'rio-tiler-crs',
        bounds: [[76.79677030658075, -82.93633501037206], [79.34081659677736, -69.69194862994055]]
      }).addTo(map)

      L.polygon([
        [76.79677030658075, -82.93633501037206],
        [76.79677030658075, -69.69194862994055],
        [79.34081659677736, -69.69194862994055],
        [79.34081659677736, -82.93633501037206],
        [76.79677030658075, -82.93633501037206]
      ]).addTo(map)


      // DEBUG
      L.GridLayer.GridDebug = L.GridLayer.extend({
        createTile: function (coords) {
          const tile = document.createElement('div')
          tile.style.outline = '1px solid green'
          tile.style.fontWeight = 'bold'
          tile.style.fontSize = '14pt'
          tile.innerHTML = [coords.z, coords.x, coords.y].join('/')
          return tile;
        },
      })

      L.gridLayer.gridDebug = function (opts) {
        return new L.GridLayer.GridDebug(opts)
      }
      map.addLayer(L.gridLayer.gridDebug())
      map.setView([9, 76], 9)
    </script>
  
  </body>
</html>